import{a as v,b as k,u as y,r as i,j as e,S as w,p as N,z as r}from"./index-tqXRR1Pi.js";import{P as D}from"./PostForm-CPG-dn-u.js";function z(){const{id:n}=v(),s=k(),{user:l}=y(),[c,x]=i.useState(null),[b,g]=i.useState(!0),[E,u]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const t=(await N.getOne(n)).data.data.post;if(t.author._id!==l._id){r.error("You are not authorized to edit this post"),s("/my-posts");return}x(t)}catch{r.error("Failed to load post"),s("/my-posts")}finally{g(!1)}})()},[n,l._id,s]);const j=async m=>{var o,t,d,p;try{u(!0);const a=await N.update(n,m);r.success("Post updated successfully!"),s(`/posts/${a.data.data.post.slug||a.data.data.post._id}`)}catch(a){const P=((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to update post",f=(p=(d=a.response)==null?void 0:d.data)==null?void 0:p.details;f?f.forEach(h=>r.error(`${h.field}: ${h.message}`)):r.error(P)}finally{u(!1)}};return b?e.jsxDEV("div",{className:"flex justify-center py-16",children:e.jsxDEV(w,{size:"lg"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:65,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:64,columnNumber:7},this):c?e.jsxDEV("div",{className:"max-w-2xl mx-auto",children:[e.jsxDEV("button",{onClick:()=>s(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:81,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:80,columnNumber:9},this),"Back"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:76,columnNumber:7},this),e.jsxDEV("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Edit Post"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:86,columnNumber:7},this),e.jsxDEV("p",{className:"text-gray-600 mb-8",children:"Update your post details"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:87,columnNumber:7},this),e.jsxDEV("div",{className:"card p-6 md:p-8",children:e.jsxDEV(D,{initialData:c,onSubmit:j,isLoading:E,submitText:"Update Post"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:90,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:89,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/EditPost.jsx",lineNumber:75,columnNumber:5},this):null}export{z as default};

import{b as S,u as A,r as m,j as e,c as P,z as u}from"./index-tqXRR1Pi.js";function $(){const k=S(),{user:s,logout:E}=A(),[j,p]=m.useState(!1),[g,b]=m.useState(!1),[d,t]=m.useState(!1),[f,v]=m.useState({username:(s==null?void 0:s.username)||"",email:(s==null?void 0:s.email)||""}),[l,w]=m.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,c]=m.useState({}),D=o=>{const{name:r,value:i}=o.target;v(n=>({...n,[r]:i})),a[r]&&c(n=>({...n,[r]:""}))},x=o=>{const{name:r,value:i}=o.target;w(n=>({...n,[r]:i})),a[r]&&c(n=>({...n,[r]:""}))},V=async o=>{var i,n;o.preventDefault();const r={};if(f.username.length<3&&(r.username="Username must be at least 3 characters"),f.email.match(/^\S+@\S+\.\S+$/)||(r.email="Please enter a valid email"),Object.keys(r).length>0){c(r);return}try{t(!0),await P.patch("/auth/update-profile",f),u.success("Profile updated successfully"),p(!1),window.location.reload()}catch(N){const h=((n=(i=N.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to update profile";u.error(h)}finally{t(!1)}},y=async o=>{var i,n;o.preventDefault();const r={};if(l.currentPassword||(r.currentPassword="Current password is required"),l.newPassword.length<6&&(r.newPassword="Password must be at least 6 characters"),l.newPassword!==l.confirmPassword&&(r.confirmPassword="Passwords do not match"),Object.keys(r).length>0){c(r);return}try{t(!0);const N=await P.patch("/auth/change-password",{currentPassword:l.currentPassword,newPassword:l.newPassword});localStorage.setItem("token",N.data.data.token),u.success("Password changed successfully"),b(!1),w({currentPassword:"",newPassword:"",confirmPassword:""})}catch(N){const h=((n=(i=N.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to change password";u.error(h),h.includes("incorrect")&&c({currentPassword:"Current password is incorrect"})}finally{t(!1)}},C=async()=>{if(window.confirm("Are you sure you want to delete your account? This action cannot be undone."))try{t(!0),await P.delete("/auth/delete-account"),E(),k("/"),u.success("Account deleted successfully")}catch{u.error("Failed to delete account")}finally{t(!1)}};return e.jsxDEV("div",{className:"max-w-2xl mx-auto",children:[e.jsxDEV("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Profile Settings"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:141,columnNumber:7},this),e.jsxDEV("div",{className:"card p-6 mb-6",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile Information"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:146,columnNumber:11},this),!j&&e.jsxDEV("button",{onClick:()=>p(!0),className:"btn-secondary text-sm",children:"Edit"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:148,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:145,columnNumber:9},this),j?e.jsxDEV("form",{onSubmit:V,className:"space-y-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"username",className:"label",children:"Username"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:160,columnNumber:15},this),e.jsxDEV("input",{type:"text",id:"username",name:"username",value:f.username,onChange:D,className:`input ${a.username?"input-error":""}`},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:161,columnNumber:15},this),a.username&&e.jsxDEV("p",{className:"error-text",children:a.username},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:169,columnNumber:35},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:159,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"email",className:"label",children:"Email"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:173,columnNumber:15},this),e.jsxDEV("input",{type:"email",id:"email",name:"email",value:f.email,onChange:D,className:`input ${a.email?"input-error":""}`},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:174,columnNumber:15},this),a.email&&e.jsxDEV("p",{className:"error-text",children:a.email},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:182,columnNumber:32},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:172,columnNumber:13},this),e.jsxDEV("div",{className:"flex gap-3",children:[e.jsxDEV("button",{type:"submit",disabled:d,className:"btn-primary",children:d?"Saving...":"Save Changes"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:186,columnNumber:15},this),e.jsxDEV("button",{type:"button",onClick:()=>{p(!1),v({username:(s==null?void 0:s.username)||"",email:(s==null?void 0:s.email)||""}),c({})},className:"btn-secondary",children:"Cancel"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:193,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:185,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:158,columnNumber:11},this):e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Username"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:212,columnNumber:15},this),e.jsxDEV("p",{className:"font-medium",children:s==null?void 0:s.username},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:213,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:211,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Email"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:216,columnNumber:15},this),e.jsxDEV("p",{className:"font-medium",children:s==null?void 0:s.email},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:217,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:215,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Member since"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:220,columnNumber:15},this),e.jsxDEV("p",{className:"font-medium",children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:221,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:219,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:210,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:144,columnNumber:7},this),e.jsxDEV("div",{className:"card p-6 mb-6",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900",children:"Password"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:232,columnNumber:11},this),!g&&e.jsxDEV("button",{onClick:()=>b(!0),className:"btn-secondary text-sm",children:"Change Password"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:234,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:231,columnNumber:9},this),g&&e.jsxDEV("form",{onSubmit:y,className:"space-y-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"currentPassword",className:"label",children:"Current Password"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:246,columnNumber:15},this),e.jsxDEV("input",{type:"password",id:"currentPassword",name:"currentPassword",value:l.currentPassword,onChange:x,className:`input ${a.currentPassword?"input-error":""}`},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:247,columnNumber:15},this),a.currentPassword&&e.jsxDEV("p",{className:"error-text",children:a.currentPassword},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:255,columnNumber:42},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:245,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"newPassword",className:"label",children:"New Password"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:259,columnNumber:15},this),e.jsxDEV("input",{type:"password",id:"newPassword",name:"newPassword",value:l.newPassword,onChange:x,className:`input ${a.newPassword?"input-error":""}`},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:260,columnNumber:15},this),a.newPassword&&e.jsxDEV("p",{className:"error-text",children:a.newPassword},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:268,columnNumber:38},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:258,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"confirmPassword",className:"label",children:"Confirm New Password"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:272,columnNumber:15},this),e.jsxDEV("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:l.confirmPassword,onChange:x,className:`input ${a.confirmPassword?"input-error":""}`},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:273,columnNumber:15},this),a.confirmPassword&&e.jsxDEV("p",{className:"error-text",children:a.confirmPassword},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:281,columnNumber:42},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:271,columnNumber:13},this),e.jsxDEV("div",{className:"flex gap-3",children:[e.jsxDEV("button",{type:"submit",disabled:d,className:"btn-primary",children:d?"Changing...":"Change Password"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:285,columnNumber:15},this),e.jsxDEV("button",{type:"button",onClick:()=>{b(!1),w({currentPassword:"",newPassword:"",confirmPassword:""}),c({})},className:"btn-secondary",children:"Cancel"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:292,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:284,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:244,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:230,columnNumber:7},this),e.jsxDEV("div",{className:"card p-6 border-red-200 bg-red-50",children:[e.jsxDEV("h2",{className:"text-xl font-semibold text-red-700 mb-2",children:"Danger Zone"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:314,columnNumber:9},this),e.jsxDEV("p",{className:"text-red-600 text-sm mb-4",children:"Once you delete your account, there is no going back. Please be certain."},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:315,columnNumber:9},this),e.jsxDEV("button",{onClick:C,disabled:d,className:"btn-danger",children:"Delete Account"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:318,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:313,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/Profile.jsx",lineNumber:140,columnNumber:5},this)}export{$ as default};
